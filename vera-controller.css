/* =============================================================================
   VERA ANIMATION CONTROLLER v4.0.0 - CSS
   MASSIVE OVERHAUL: Fixed ALL glitching - Buttery smooth animations
   - Removed ALL scaleY transforms (cause of glitching)
   - Disabled conflicting GSAP system
   - Pure CSS animations with GPU acceleration
   - Professional cubic-bezier easing curves
   - V2 layered system perfected (8 layers, 1024x1024 aligned)
   ============================================================================= */

/* ==========================================================================
   CONTAINER - Moveable and positioned
   ========================================================================== */
.vera-container {
    position: fixed;
    width: 200px;
    height: 200px;
    z-index: 9990;  /* High enough to be above UI (1000) but below modals (9999+) */
    cursor: pointer;
    /* Remove default right/bottom positioning - JS handles position */
    /* Prevent clipping by parent elements */
    contain: none;
}

.vera-container:hover {
    transform: scale(1.05);
}

.vera-container:active {
    transform: scale(0.95);
}

/* Flying animation when moving */
.vera-container.flying {
    transform: scale(1.1) rotate(-5deg);
}

/* Charging animation for long-press monster trigger */
.vera-container.charging {
    animation: chargingPulse 0.3s ease-in-out infinite;
}

.vera-container.charging .vera-aura {
    animation: chargingAura 0.2s ease-in-out infinite !important;
    background: radial-gradient(circle at 40% 35%,
        rgba(220, 38, 38, 0.6) 0%,
        rgba(185, 28, 28, 0.4) 35%,
        rgba(127, 29, 29, 0.2) 60%,
        transparent 80%) !important;
}

@keyframes chargingPulse {
    0%, 100% { transform: scale(1); filter: brightness(1); }
    50% { transform: scale(1.08); filter: brightness(1.2); }
}

@keyframes chargingAura {
    0%, 100% { opacity: 0.7; transform: scale(1.1); }
    50% { opacity: 1; transform: scale(1.3); }
}

/* ==========================================================================
   AURA GLOW - Soft magical background
   ========================================================================== */
.vera-aura {
    position: absolute;
    inset: -30px;
    border-radius: 50%;
    pointer-events: none;
    filter: blur(15px);
    opacity: 0.6;
}

/* Fairy aura - soft cyan/purple/pink */
.vera-container.fairy .vera-aura {
    background: radial-gradient(circle at 40% 35%,
        rgba(147, 197, 253, 0.5) 0%,
        rgba(196, 181, 253, 0.35) 35%,
        rgba(251, 207, 232, 0.2) 60%,
        transparent 80%);
    animation: auraFairyPulse 4s ease-in-out infinite;
}

/* Partial aura - warming up */
.vera-container.partial .vera-aura {
    background: radial-gradient(circle at 40% 35%,
        rgba(253, 186, 116, 0.45) 0%,
        rgba(251, 146, 60, 0.3) 35%,
        rgba(196, 181, 253, 0.2) 60%,
        transparent 80%);
    animation: auraPartialPulse 2.5s ease-in-out infinite;
}

/* Takeover aura - danger */
.vera-container.takeover .vera-aura {
    background: radial-gradient(circle at 40% 35%,
        rgba(248, 113, 113, 0.5) 0%,
        rgba(239, 68, 68, 0.4) 35%,
        rgba(127, 29, 29, 0.25) 60%,
        transparent 80%);
    animation: auraTakeoverPulse 1.8s ease-in-out infinite;
}

/* Monster aura - full rage */
.vera-container.monster .vera-aura {
    background: radial-gradient(circle at 40% 35%,
        rgba(220, 38, 38, 0.6) 0%,
        rgba(185, 28, 28, 0.5) 30%,
        rgba(127, 29, 29, 0.35) 55%,
        transparent 80%);
    animation: auraMonsterPulse 1.2s ease-in-out infinite;
    filter: blur(18px);
}

@keyframes auraFairyPulse {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.08); }
}

@keyframes auraPartialPulse {
    0%, 100% { opacity: 0.5; transform: scale(1) rotate(0deg); }
    50% { opacity: 0.75; transform: scale(1.1) rotate(2deg); }
}

@keyframes auraTakeoverPulse {
    0%, 100% { opacity: 0.6; transform: scale(1); }
    50% { opacity: 0.9; transform: scale(1.15); }
}

@keyframes auraMonsterPulse {
    0%, 100% { opacity: 0.7; transform: scale(1.05); filter: blur(18px); }
    50% { opacity: 1; transform: scale(1.25); filter: blur(22px); }
}

/* ==========================================================================
   SPARKLES - Soft CSS particles (no canvas)
   ========================================================================== */
.vera-sparkles {
    position: absolute;
    inset: -40px;
    pointer-events: none;
    z-index: 0;
}

.vera-sparkle {
    position: absolute;
    width: var(--size, 6px);
    height: var(--size, 6px);
    left: var(--x, 50%);
    top: var(--y, 50%);
    border-radius: 50%;
    animation: sparkleFloat var(--duration, 3s) ease-in-out infinite;
    animation-delay: var(--delay, 0s);
    opacity: 0;
}

/* Fairy sparkles - pink, lavender, mint pastels (matching sprite sheet) */
.vera-container.fairy .vera-sparkle {
    background: radial-gradient(circle,
        rgba(255, 255, 255, 1) 0%,
        rgba(244, 182, 212, 0.85) 40%,
        rgba(196, 181, 253, 0.5) 70%,
        transparent 100%);
    box-shadow: 0 0 6px rgba(244, 182, 212, 0.5);
}

.vera-container.fairy .vera-sparkle:nth-child(2n) {
    background: radial-gradient(circle,
        rgba(255, 255, 255, 1) 0%,
        rgba(196, 181, 253, 0.85) 40%,
        rgba(167, 243, 208, 0.4) 70%,
        transparent 100%);
    box-shadow: 0 0 6px rgba(196, 181, 253, 0.5);
}

.vera-container.fairy .vera-sparkle:nth-child(3n) {
    background: radial-gradient(circle,
        rgba(255, 255, 255, 1) 0%,
        rgba(167, 243, 208, 0.85) 40%,
        rgba(244, 182, 212, 0.4) 70%,
        transparent 100%);
    box-shadow: 0 0 6px rgba(167, 243, 208, 0.5);
}

/* Partial sparkles - orange tinted */
.vera-container.partial .vera-sparkle {
    background: radial-gradient(circle,
        rgba(255, 255, 255, 1) 0%,
        rgba(253, 186, 116, 0.8) 40%,
        rgba(251, 146, 60, 0.4) 70%,
        transparent 100%);
    box-shadow: 0 0 8px rgba(251, 146, 60, 0.6);
}

/* Takeover sparkles - red embers */
.vera-container.takeover .vera-sparkle {
    background: radial-gradient(circle,
        rgba(255, 220, 180, 1) 0%,
        rgba(248, 113, 113, 0.9) 40%,
        rgba(239, 68, 68, 0.5) 70%,
        transparent 100%);
    box-shadow: 0 0 10px rgba(239, 68, 68, 0.7);
    animation: sparkleEmber var(--duration, 2s) ease-in-out infinite;
}

/* Monster sparkles - orange, pink, peach (matching sprite sheet) */
.vera-container.monster .vera-sparkle {
    background: radial-gradient(circle,
        rgba(255, 255, 255, 1) 0%,
        rgba(251, 146, 60, 0.9) 40%,
        rgba(244, 182, 212, 0.5) 70%,
        transparent 100%);
    box-shadow: 0 0 10px rgba(251, 146, 60, 0.7);
    animation: sparkleRage var(--duration, 1.5s) ease-in-out infinite;
}

.vera-container.monster .vera-sparkle:nth-child(2n) {
    background: radial-gradient(circle,
        rgba(255, 255, 255, 1) 0%,
        rgba(244, 182, 212, 0.9) 40%,
        rgba(251, 146, 60, 0.5) 70%,
        transparent 100%);
    box-shadow: 0 0 10px rgba(244, 182, 212, 0.6);
}

.vera-container.monster .vera-sparkle:nth-child(3n) {
    background: radial-gradient(circle,
        rgba(255, 255, 255, 1) 0%,
        rgba(254, 215, 170, 0.9) 40%,
        rgba(251, 146, 60, 0.5) 70%,
        transparent 100%);
    box-shadow: 0 0 10px rgba(254, 215, 170, 0.6);
}

@keyframes sparkleFloat {
    0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.3) translateY(10px);
    }
    15% {
        opacity: 0.9;
        transform: translate(-50%, -50%) scale(1) translateY(0);
    }
    85% {
        opacity: 0.9;
        transform: translate(-50%, -50%) scale(1.1) translateY(-15px);
    }
    100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.3) translateY(-25px);
    }
}

@keyframes sparkleEmber {
    0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.5);
    }
    20% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1.2);
    }
    50% {
        opacity: 0.8;
        transform: translate(-50%, -50%) scale(0.9) translateY(-10px);
    }
    80% {
        opacity: 0.9;
        transform: translate(-50%, -50%) scale(1.1) translateY(-20px);
    }
    100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.4) translateY(-30px);
    }
}

@keyframes sparkleRage {
    0% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.6) rotate(0deg);
    }
    25% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1.3) rotate(45deg);
    }
    50% {
        opacity: 0.9;
        transform: translate(-50%, -50%) scale(1) rotate(90deg) translateY(-10px);
    }
    75% {
        opacity: 0.8;
        transform: translate(-50%, -50%) scale(1.2) rotate(135deg) translateY(-20px);
    }
    100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.5) rotate(180deg) translateY(-35px);
    }
}

/* ==========================================================================
   STAGE - Main sprite container with floating
   ========================================================================== */
.vera-stage {
    position: relative;
    width: 100%;
    height: 100%;
    /* Isolated stacking context to prevent z-index bleed */
    isolation: isolate;
}

/* Fairy float - gentle bob */
.vera-container.fairy .vera-stage {
    animation: floatGentle 3.5s ease-in-out infinite;
}

/* Partial float - slightly faster */
.vera-container.partial .vera-stage {
    animation: floatUneasy 2.8s ease-in-out infinite;
}

/* Takeover float - aggressive */
.vera-container.takeover .vera-stage {
    animation: floatAngry 2s ease-in-out infinite;
}

/* Monster float - powerful, menacing hover (NOT glitchy shake) */
.vera-container.monster .vera-stage {
    animation: floatMenacing 3s ease-in-out infinite;
}

@keyframes floatGentle {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    25% { transform: translateY(-4px) rotate(0.5deg); }
    50% { transform: translateY(-8px) rotate(0deg); }
    75% { transform: translateY(-4px) rotate(-0.5deg); }
}

@keyframes floatUneasy {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    25% { transform: translateY(-5px) rotate(1deg); }
    50% { transform: translateY(-10px) rotate(-0.5deg); }
    75% { transform: translateY(-5px) rotate(-1deg); }
}

@keyframes floatAngry {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    12.5% { transform: translateY(-3px) rotate(2deg); }
    25% { transform: translateY(-8px) rotate(-1deg); }
    37.5% { transform: translateY(-5px) rotate(1.5deg); }
    50% { transform: translateY(-10px) rotate(-2deg); }
    62.5% { transform: translateY(-6px) rotate(1deg); }
    75% { transform: translateY(-4px) rotate(-1.5deg); }
    87.5% { transform: translateY(-2px) rotate(0.5deg); }
}

/* Monster float - slow powerful hover (SMOOTH - NO scaling) */
@keyframes floatMenacing {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-10px);
    }
}

/* ==========================================================================
   SPRITE LAYERS - Proper z-ordering to prevent glitching
   ========================================================================== */
.vera-layer {
    position: absolute;
    inset: 0;
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
    pointer-events: none;
    /* Prevent any bleed-through or compositing issues */
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    transform: translateZ(0);
}

/* Layer z-index order */
.vera-wings { z-index: 1; }
.vera-body { z-index: 2; }
.vera-hair { z-index: 3; }
.vera-overlay { z-index: 4; opacity: 0; }
/* Eyes layer removed - eye sprites are head crops, not overlays */

/* ==========================================================================
   FAIRY STATE SPRITES
   ========================================================================== */
.vera-container.fairy .vera-body {
    background-image: url('assets/vera/vera_fairy_body_HQ.png');
}

.vera-container.fairy .vera-wings {
    background-image: url('assets/vera/vera_fairy_wings_HQ.png');
    transform-origin: 50% 50%;
    animation: wingFlapFairy 1.4s cubic-bezier(0.37, 0, 0.63, 1) infinite;
}

.vera-container.fairy .vera-hair {
    background-image: url('assets/vera/vera_fairy_hair_HQ.png');
    transform-origin: 50% 20%;
    animation: hairSwayGentle 4s ease-in-out infinite;
}

/* Eye layer removed - sprites are head crops not eye overlays */

/* ==========================================================================
   PARTIAL STATE SPRITES
   ========================================================================== */
.vera-container.partial .vera-body {
    background-image: url('assets/vera/vera_partial_transform_body_HQ.png');
}

.vera-container.partial .vera-wings {
    background-image: url('assets/vera/vera_partial_transform_wings_HQ.png');
    transform-origin: 50% 50%;
    animation: wingFlapPartial 1.1s cubic-bezier(0.37, 0, 0.63, 1) infinite;
}

.vera-container.partial .vera-hair {
    background-image: url('assets/vera/vera_partial_transform_hair_HQ.png');
    transform-origin: 50% 20%;
    animation: hairSwayUneasy 2.5s ease-in-out infinite;
}

/* Partial eyes removed */

/* ==========================================================================
   TAKEOVER STATE SPRITES
   ========================================================================== */
.vera-container.takeover .vera-body {
    background-image: url('assets/vera/vera_hybrid_takeover_body.png');
}

.vera-container.takeover .vera-wings {
    background-image: url('assets/vera/vera_hybrid_takeover_wings.png');
    transform-origin: 50% 50%;
    animation: wingFlapAngry 0.8s cubic-bezier(0.37, 0, 0.63, 1) infinite;
}

.vera-container.takeover .vera-hair {
    background-image: url('assets/vera/vera_hybrid_takeover_hair.png');
    transform-origin: 50% 15%;
    animation: hairSwayWild 1.5s ease-in-out infinite;
}

/* Takeover eyes removed */

/* ==========================================================================
   MONSTER STATE SPRITES
   ========================================================================== */
.vera-container.monster .vera-body {
    background-image: url('assets/vera/vera_monster_body_HQ.png');
}

.vera-container.monster .vera-wings {
    background-image: url('assets/vera/vera_monster_wings_HQ.png');
    transform-origin: 50% 50%;
    animation: wingFlapMonster 1.8s cubic-bezier(0.37, 0, 0.63, 1) infinite;
}

.vera-container.monster .vera-hair {
    background-image: url('assets/vera/vera_monster_hair_HQ.png');
    transform-origin: 50% 12%;
    animation: hairSwayMonster 2.5s ease-in-out infinite;
}

/* Monster eyes removed */

/* ==========================================================================
   LEGACY WING ANIMATIONS - DISABLED (V2 mode uses v2WingFlapLeft/Right)
   These are kept for old sprite modes but not used in V2
   ========================================================================== */
/* Legacy animations removed - V2 system uses cleaner keyframes */

/* ==========================================================================
   LEGACY HAIR ANIMATIONS - DISABLED (V2 mode uses v2HairSway)
   These are kept for old sprite modes but not used in V2
   ========================================================================== */
/* Legacy animations removed - V2 system uses cleaner keyframes */

/* ==========================================================================
   FACE POP OVERLAY
   ========================================================================== */
/* Face pop overlay - appears BRIEFLY during transition then fades */
.vera-overlay {
    z-index: 10 !important; /* Above all other layers */
    transition: opacity 0.3s ease-out;
}

.vera-overlay.active {
    opacity: 1;
    animation: facePopBurst 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

/* Auto-fade after showing */
.vera-overlay.fading {
    opacity: 0 !important;
    transition: opacity 0.4s ease-out;
}

.vera-container .vera-overlay.facepop {
    background-image: url('assets/vera/vera_hybrid_face_pop.png');
}

.vera-container .vera-overlay.facepop-extreme {
    background-image: url('assets/vera/vera_hybrid_face_pop_EXTREME.png');
}

@keyframes facePopBurst {
    0% {
        opacity: 0;
        transform: scale(0.5);
        filter: brightness(2.5);
    }
    30% {
        opacity: 1;
        transform: scale(1.2);
        filter: brightness(1.5);
    }
    60% {
        opacity: 1;
        transform: scale(1);
        filter: brightness(1.2);
    }
    100% {
        opacity: 0.8;
        transform: scale(1);
        filter: brightness(1);
    }
}

/* ==========================================================================
   TRANSFORMATION ANIMATION
   ========================================================================== */
.vera-container.transforming .vera-stage {
    animation: transformBurst 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes transformBurst {
    0% {
        transform: scale(1);
        filter: brightness(1) saturate(1);
    }
    30% {
        transform: scale(1.2) rotate(-5deg);
        filter: brightness(1.5) saturate(1.3);
    }
    50% {
        transform: scale(0.85) rotate(5deg);
        filter: brightness(1.8) saturate(0.8);
    }
    70% {
        transform: scale(1.1) rotate(-2deg);
        filter: brightness(1.3) saturate(1.1);
    }
    100% {
        transform: scale(1) rotate(0);
        filter: brightness(1) saturate(1);
    }
}

/* ==========================================================================
   HELP BADGE
   ========================================================================== */
.vera-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    width: 30px;
    height: 30px;
    background: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    font-weight: 900;
    color: #fff;
    cursor: pointer;
    z-index: 10;
    box-shadow: 0 2px 10px rgba(239, 68, 68, 0.5);
    transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
    animation: badgePulse 3s ease-in-out infinite;
}

.vera-badge:hover {
    transform: scale(1.2);
    box-shadow: 0 4px 20px rgba(239, 68, 68, 0.7);
}

@keyframes badgePulse {
    0%, 100% {
        box-shadow: 0 2px 10px rgba(239, 68, 68, 0.5);
    }
    50% {
        box-shadow: 0 2px 20px rgba(239, 68, 68, 0.8), 0 0 30px rgba(239, 68, 68, 0.3);
    }
}

/* ==========================================================================
   SPEECH BUBBLE - Smart positioning based on corner
   ========================================================================== */
.vera-speech {
    position: absolute;
    width: 220px;
    max-width: 220px;
    padding: 14px 16px 14px 16px;
    background: rgba(15, 23, 42, 0.8);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(148, 163, 184, 0.2);
    border-radius: 16px;
    font-family: system-ui, -apple-system, sans-serif;
    font-size: 13px;
    line-height: 1.5;
    color: #e2e8f0;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
    opacity: 0;
    transform: translateY(10px) scale(0.95);
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    pointer-events: none;
    z-index: 20;
    /* Default: bottom-right corner - speech goes above-left */
    bottom: calc(100% + 15px);
    right: -10px;
}

/* X Close Button - Top Right Corner */
.vera-speech-close {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 24px;
    height: 24px;
    background: rgba(148, 163, 184, 0.15);
    border: 1px solid rgba(148, 163, 184, 0.3);
    border-radius: 6px;
    color: #cbd5e1;
    font-size: 18px;
    font-weight: 600;
    line-height: 1;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    transition: all 0.2s ease;
    pointer-events: auto;
    z-index: 1;
}

.vera-speech-close:hover {
    background: rgba(239, 68, 68, 0.2);
    border-color: rgba(239, 68, 68, 0.5);
    color: #fca5a5;
    transform: scale(1.1);
}

.vera-speech-close:active {
    transform: scale(0.95);
}

.vera-speech::after {
    content: '';
    position: absolute;
    width: 0;
    height: 0;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    /* Default: pointer at bottom-right */
    bottom: -10px;
    right: 30px;
    border-top: 10px solid rgba(15, 23, 42, 0.8);
    border-bottom: none;
}

/* Bottom-right corner: speech above, pointing down-right */
.vera-speech.pos-bottom-right {
    bottom: calc(100% + 15px);
    top: auto;
    right: -10px;
    left: auto;
}
.vera-speech.pos-bottom-right::after {
    bottom: -10px;
    top: auto;
    right: 30px;
    left: auto;
    border-top: 10px solid rgba(15, 23, 42, 0.8);
    border-bottom: none;
}

/* Bottom-left corner: speech above, pointing down-left */
.vera-speech.pos-bottom-left {
    bottom: calc(100% + 15px);
    top: auto;
    left: -10px;
    right: auto;
}
.vera-speech.pos-bottom-left::after {
    bottom: -10px;
    top: auto;
    left: 30px;
    right: auto;
    border-top: 10px solid rgba(15, 23, 42, 0.8);
    border-bottom: none;
}

/* Top-right corner: speech below, pointing up-right */
.vera-speech.pos-top-right {
    top: calc(100% + 15px);
    bottom: auto;
    right: -10px;
    left: auto;
}
.vera-speech.pos-top-right::after {
    top: -10px;
    bottom: auto;
    right: 30px;
    left: auto;
    border-bottom: 10px solid rgba(15, 23, 42, 0.8);
    border-top: none;
}

/* Top-left corner: speech below, pointing up-left */
.vera-speech.pos-top-left {
    top: calc(100% + 15px);
    bottom: auto;
    left: -10px;
    right: auto;
}
.vera-speech.pos-top-left::after {
    top: -10px;
    bottom: auto;
    left: 30px;
    right: auto;
    border-bottom: 10px solid rgba(15, 23, 42, 0.8);
    border-top: none;
}

.vera-container:hover .vera-speech,
.vera-speech.visible {
    opacity: 1;
    transform: translateY(0) scale(1);
    pointer-events: auto;
}

.vera-speech-title {
    font-weight: 700;
    margin-bottom: 6px;
    display: flex;
    align-items: center;
    gap: 6px;
}

/* Fairy speech */
.vera-container.fairy .vera-speech {
    border-color: rgba(147, 197, 253, 0.3);
}
.vera-container.fairy .vera-speech-title {
    color: #93c5fd;
}

/* Partial speech */
.vera-container.partial .vera-speech {
    border-color: rgba(253, 186, 116, 0.3);
}
.vera-container.partial .vera-speech-title {
    color: #fdba74;
}

/* Takeover speech */
.vera-container.takeover .vera-speech {
    border-color: rgba(248, 113, 113, 0.4);
}
.vera-container.takeover .vera-speech-title {
    color: #f87171;
}

/* Monster speech */
.vera-container.monster .vera-speech {
    border-color: rgba(220, 38, 38, 0.5);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5), 0 0 20px rgba(220, 38, 38, 0.2);
}
.vera-container.monster .vera-speech-title {
    color: #dc2626;
}

/* Login prompt speech bubble - wider for buttons */
.vera-speech.type-login {
    width: 280px;
    max-width: 280px;
    padding: 16px 18px;
}

.vera-speech.type-login .vera-speech-title {
    color: #5eead4;
    font-size: 14px;
}

/* Login button container */
.vera-speech-buttons {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 14px;
    padding-top: 12px;
    border-top: 1px solid rgba(148, 163, 184, 0.15);
}

/* Login button styles */
.vera-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 10px 16px;
    border: none;
    border-radius: 10px;
    font-family: system-ui, -apple-system, sans-serif;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.vera-btn span {
    font-size: 16px;
    transition: transform 0.25s ease;
}

.vera-btn:hover span {
    transform: scale(1.15);
}

.vera-btn:active {
    transform: scale(0.97);
}

/* Primary button - Sign Up (teal gradient) */
.vera-btn-primary {
    background: linear-gradient(135deg, #14b8a6 0%, #22d3ee 100%);
    color: #0a0d14;
    box-shadow: 0 2px 8px rgba(94, 234, 212, 0.25);
}

.vera-btn-primary:hover {
    background: linear-gradient(135deg, #0d9488 0%, #14b8a6 100%);
    box-shadow: 0 4px 16px rgba(94, 234, 212, 0.4);
    transform: translateY(-2px);
}

/* Secondary button - Log In (purple gradient) */
.vera-btn-secondary {
    background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%);
    color: #f8fafc;
    box-shadow: 0 2px 8px rgba(124, 58, 237, 0.25);
}

.vera-btn-secondary:hover {
    background: linear-gradient(135deg, #6366f1 0%, #7c3aed 100%);
    box-shadow: 0 4px 16px rgba(124, 58, 237, 0.4);
    transform: translateY(-2px);
}

/* Ghost button - Continue as Guest (subtle) */
.vera-btn-ghost {
    background: rgba(148, 163, 184, 0.1);
    color: #cbd5e1;
    border: 1px solid rgba(148, 163, 184, 0.2);
    box-shadow: none;
}

.vera-btn-ghost:hover {
    background: rgba(148, 163, 184, 0.15);
    border-color: rgba(148, 163, 184, 0.3);
    color: #e2e8f0;
    transform: translateY(-1px);
}

/* Shimmer effect on primary button */
.vera-btn-primary::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.5s ease;
}

.vera-btn-primary:hover::before {
    left: 100%;
}

/* ==========================================================================
   SCREEN EFFECTS
   ========================================================================== */
.vera-screen-flash {
    position: fixed;
    inset: 0;
    z-index: 9999;
    pointer-events: none;
    animation: screenFlashFade 0.4s ease-out forwards;
}

.vera-screen-flash.fairy {
    background: radial-gradient(circle at 80% 80%,
        rgba(147, 197, 253, 0.4) 0%,
        rgba(196, 181, 253, 0.2) 40%,
        transparent 70%);
}

.vera-screen-flash.takeover {
    background: radial-gradient(circle at 80% 80%,
        rgba(248, 113, 113, 0.4) 0%,
        rgba(239, 68, 68, 0.2) 40%,
        transparent 70%);
}

.vera-screen-flash.monster {
    background: radial-gradient(circle at 80% 80%,
        rgba(220, 38, 38, 0.5) 0%,
        rgba(185, 28, 28, 0.3) 40%,
        transparent 70%);
}

@keyframes screenFlashFade {
    0% { opacity: 1; }
    100% { opacity: 0; }
}

/* Screen shake */
@keyframes screenShakeVera {
    0%, 100% { transform: translate(0, 0); }
    10% { transform: translate(-4px, -2px); }
    20% { transform: translate(4px, 3px); }
    30% { transform: translate(-3px, 2px); }
    40% { transform: translate(3px, -3px); }
    50% { transform: translate(-4px, 3px); }
    60% { transform: translate(4px, -2px); }
    70% { transform: translate(-3px, -3px); }
    80% { transform: translate(3px, 2px); }
    90% { transform: translate(-2px, -2px); }
}

body.vera-shake {
    animation: screenShakeVera 0.6s ease-in-out;
}

/* ==========================================================================
   PNG FALLBACK (for browsers without webp)
   ========================================================================== */
@supports not (background-image: url('test.webp')) {
    .vera-container.fairy .vera-body { background-image: url('assets/vera/vera_fairy_body_HQ.png'); }
    .vera-container.fairy .vera-wings { background-image: url('assets/vera/vera_fairy_wings_HQ.png'); }
    .vera-container.fairy .vera-hair { background-image: url('assets/vera/vera_fairy_hair_HQ.png'); }

    .vera-container.partial .vera-body { background-image: url('assets/vera/vera_partial_transform_body_HQ.png'); }
    .vera-container.partial .vera-wings { background-image: url('assets/vera/vera_partial_transform_wings_HQ.png'); }
    .vera-container.partial .vera-hair { background-image: url('assets/vera/vera_partial_transform_hair_HQ.png'); }

    .vera-container.takeover .vera-body { background-image: url('assets/vera/vera_hybrid_takeover_body.png'); }
    .vera-container.takeover .vera-wings { background-image: url('assets/vera/vera_hybrid_takeover_wings.png'); }
    .vera-container.takeover .vera-hair { background-image: url('assets/vera/vera_hybrid_takeover_hair.png'); }

    .vera-container.monster .vera-body { background-image: url('assets/vera/vera_monster_body_HQ.png'); }
    .vera-container.monster .vera-wings { background-image: url('assets/vera/vera_monster_wings_HQ.png'); }
    .vera-container.monster .vera-hair { background-image: url('assets/vera/vera_monster_hair_HQ.png'); }

    .vera-container .vera-overlay.facepop { background-image: url('assets/vera/vera_hybrid_face_pop.png'); }
    .vera-container .vera-overlay.facepop-extreme { background-image: url('assets/vera/vera_hybrid_face_pop_EXTREME.png'); }
}

/* ==========================================================================
   RESPONSIVE
   ========================================================================== */
@media (max-width: 480px) {
    .vera-container {
        width: 80px;
        height: 80px;
    }

    .vera-speech {
        width: 160px;
        max-width: 160px;
        padding: 10px 12px;
        font-size: 11px;
        background: rgba(15, 23, 42, 0.55);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        right: -20px;
    }

    .vera-speech::after {
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-top: 8px solid rgba(15, 23, 42, 0.55);
        bottom: -8px;
        right: 20px;
    }

    /* Position adjustments for mobile corners */
    .vera-speech.pos-bottom-right::after,
    .vera-speech.pos-bottom-left::after {
        border-top-color: rgba(15, 23, 42, 0.55);
    }
    .vera-speech.pos-top-right::after,
    .vera-speech.pos-top-left::after {
        border-bottom-color: rgba(15, 23, 42, 0.55);
    }

    .vera-badge {
        width: 22px;
        height: 22px;
        font-size: 12px;
        top: -5px;
        right: -5px;
    }

    .vera-sparkles {
        inset: -20px;
    }

    .vera-aura {
        inset: -15px;
        filter: blur(10px);
    }
}

/* Hide during keyboard on mobile */
@media (max-height: 500px) {
    .vera-container {
        display: none;
    }
}

/* ==========================================================================
   BLENDER ANIMATED SPRITE MODE v1.0
   Uses pre-rendered bone-rigged animation frames
   ========================================================================== */

/* Animated sprite container - hides layer-based elements, shows single animated sprite */
.vera-container.animated-mode .vera-body,
.vera-container.animated-mode .vera-wings,
.vera-container.animated-mode .vera-hair,
.vera-container.animated-mode .vera-overlay {
    display: none !important;
}

/* The animated sprite element */
.vera-animated-sprite {
    position: absolute;
    width: 100%;
    height: 100%;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    z-index: 10;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

/* Fairy animated frames */
.vera-container.fairy.animated-mode .vera-animated-sprite {
    background-image: url('assets/vera/vera_fairy_frame_00.png');
    animation: veraFairyFrames 1s steps(1) infinite;
}

@keyframes veraFairyFrames {
    0%      { background-image: url('assets/vera/vera_fairy_frame_00.png'); }
    12.5%   { background-image: url('assets/vera/vera_fairy_frame_01.png'); }
    25%     { background-image: url('assets/vera/vera_fairy_frame_02.png'); }
    37.5%   { background-image: url('assets/vera/vera_fairy_frame_03.png'); }
    50%     { background-image: url('assets/vera/vera_fairy_frame_04.png'); }
    62.5%   { background-image: url('assets/vera/vera_fairy_frame_05.png'); }
    75%     { background-image: url('assets/vera/vera_fairy_frame_06.png'); }
    87.5%   { background-image: url('assets/vera/vera_fairy_frame_07.png'); }
}

/* Hover effect for animated mode */
.vera-container.animated-mode:hover .vera-animated-sprite {
    filter: brightness(1.1) drop-shadow(0 0 10px rgba(147, 197, 253, 0.6));
}

/* Poke/click effect */
.vera-container.animated-mode:active .vera-animated-sprite {
    filter: brightness(1.2) drop-shadow(0 0 15px rgba(251, 207, 232, 0.8));
    transform: scale(0.95);
}

/* Responsive animated sprite */
@media (max-width: 480px) {
    .vera-animated-sprite {
        transform: scale(1.1);
    }
}

/* ==========================================================================
   NEW ANIMATED GIF MODE - v3 Visible GIFs (Single animated image)
   ========================================================================== */

/* GIF mode uses a single animated GIF for each state */
.vera-container.gif-mode .vera-body {
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
}

/* Hide other layers in GIF mode (body contains full animation) */
.vera-container.gif-mode .vera-wings,
.vera-container.gif-mode .vera-hair,
.vera-container.gif-mode .vera-animated-sprite {
    display: none !important;
}

/* Fairy state - new visible GIF */
.vera-container.gif-mode.fairy .vera-body {
    background-image: url('assets/vera/vera_blurb_v3_fairy_VISIBLE.gif');
}

/* Monster state - new visible GIF */
.vera-container.gif-mode.monster .vera-body {
    background-image: url('assets/vera/vera_blurb_v3_monster_VISIBLE.gif');
}

/* Partial and takeover use the same as before in GIF mode (fallback to existing) */
.vera-container.gif-mode.partial .vera-body {
    background-image: url('assets/vera/vera_hybrid_takeover.png');
}

.vera-container.gif-mode.takeover .vera-body {
    background-image: url('assets/vera/vera_hybrid_takeover.png');
}

/* ==========================================================================
   V2 LAYERED ANIMATION MODE - PERFECT ANIME-STYLE VERA
   Each form has 8 layers: body, head, eyes, mouth, hair, wing_left, wing_right, tail
   ========================================================================== */

/* Hide old layers when V2 mode is active */
.vera-container.v2-mode .vera-body,
.vera-container.v2-mode .vera-wings,
.vera-container.v2-mode .vera-hair,
.vera-container.v2-mode .vera-animated-sprite {
    display: none !important;
}

/* V2 Layers container - GPU accelerated with 3D perspective */
.vera-v2-layers {
    position: absolute;
    inset: 0;
    pointer-events: none;
    /* GPU acceleration for smooth floating animation */
    will-change: transform;
    transform: translateZ(0);
    /* Enable 3D transforms for wings */
    perspective: 1000px;
    transform-style: preserve-3d;
}

/* V2 Layer base styles - CRITICAL: Perfect positioning + GPU acceleration */
.vera-v2-layer {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-repeat: no-repeat;
    background-position: center center;
    background-size: contain;
    pointer-events: none;
    /* CRITICAL: GPU acceleration for smooth animations - prevents glitching */
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    transform: translateZ(0);
    will-change: transform;
    /* CRITICAL: Prevent sub-pixel rendering issues */
    transform-style: preserve-3d;
    -webkit-transform-style: preserve-3d;
    /* Anti-aliasing for crisp edges */
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    /* CRITICAL: Prevent flickering during animations */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* ==========================================================================
   CRITICAL: Z-INDEX LAYERING (BOTTOM TO TOP)
   Proper stacking order prevents glitching and overlap issues
   ========================================================================== */
.vera-v2-tail {
    z-index: 1;
    /* Tail behind everything */
}
.vera-v2-wing-left {
    z-index: 2;
    /* Left wing behind body */
}
.vera-v2-wing-right {
    z-index: 3;
    /* Right wing behind body */
}
.vera-v2-body {
    z-index: 4;
    /* Body is base layer */
}
.vera-v2-head {
    z-index: 5;
    /* Head on top of body */
}
.vera-v2-mouth {
    z-index: 6;
    /* Mouth on top of head */
}
.vera-v2-eyes {
    z-index: 7;
    /* Eyes on top of mouth */
}
.vera-v2-hair {
    z-index: 8;
    /* Hair is top layer */
}

/* ==========================================================================
   TRANSFORM ORIGINS - CRITICAL FOR SMOOTH ANIMATIONS
   ========================================================================== */
.vera-v2-wing-left {
    transform-origin: 70% 50%; /* Pivot from right side (attaches to body) */
}

.vera-v2-wing-right {
    transform-origin: 30% 50%; /* Pivot from left side (attaches to body) */
}

.vera-v2-tail {
    transform-origin: 30% 20%; /* Pivot from top-left (attaches to body) */
}

.vera-v2-hair {
    transform-origin: 50% 30%; /* Pivot from top center (attaches to head) */
}

/* ===== V2 FAIRY ASSETS ===== */
.vera-container.v2-mode.fairy .vera-v2-body { background-image: url('assets/vera/v2/vera_fairy/vera_fairy_body.png'); }
.vera-container.v2-mode.fairy .vera-v2-head { background-image: url('assets/vera/v2/vera_fairy/vera_fairy_head.png'); }
.vera-container.v2-mode.fairy .vera-v2-eyes { background-image: url('assets/vera/v2/vera_fairy/vera_fairy_eyes.png'); }
.vera-container.v2-mode.fairy .vera-v2-mouth { background-image: url('assets/vera/v2/vera_fairy/vera_fairy_mouth.png'); }
.vera-container.v2-mode.fairy .vera-v2-hair { background-image: url('assets/vera/v2/vera_fairy/vera_fairy_hair.png'); }
.vera-container.v2-mode.fairy .vera-v2-wing-left { background-image: url('assets/vera/v2/vera_fairy/vera_fairy_wing_left.png'); }
.vera-container.v2-mode.fairy .vera-v2-wing-right { background-image: url('assets/vera/v2/vera_fairy/vera_fairy_wing_right.png'); }
.vera-container.v2-mode.fairy .vera-v2-tail { display: none; }

/* ===== V2 PARTIAL ASSETS ===== */
.vera-container.v2-mode.partial .vera-v2-body { background-image: url('assets/vera/v2/vera_partial/vera_partial_body.png'); }
.vera-container.v2-mode.partial .vera-v2-head { background-image: url('assets/vera/v2/vera_partial/vera_partial_head.png'); }
.vera-container.v2-mode.partial .vera-v2-eyes { background-image: url('assets/vera/v2/vera_partial/vera_partial_eyes.png'); }
.vera-container.v2-mode.partial .vera-v2-mouth { background-image: url('assets/vera/v2/vera_partial/vera_partial_mouth.png'); }
.vera-container.v2-mode.partial .vera-v2-hair { background-image: url('assets/vera/v2/vera_partial/vera_partial_hair.png'); }
.vera-container.v2-mode.partial .vera-v2-wing-left { background-image: url('assets/vera/v2/vera_partial/vera_partial_wing_left.png'); }
.vera-container.v2-mode.partial .vera-v2-wing-right { background-image: url('assets/vera/v2/vera_partial/vera_partial_wing_right.png'); }
.vera-container.v2-mode.partial .vera-v2-tail { background-image: url('assets/vera/v2/vera_partial/vera_partial_tail.png'); }

/* ===== V2 TAKEOVER ASSETS ===== */
.vera-container.v2-mode.takeover .vera-v2-body { background-image: url('assets/vera/v2/vera_takeover/vera_takeover_body.png'); }
.vera-container.v2-mode.takeover .vera-v2-head { background-image: url('assets/vera/v2/vera_takeover/vera_takeover_head.png'); }
.vera-container.v2-mode.takeover .vera-v2-eyes { background-image: url('assets/vera/v2/vera_takeover/vera_takeover_eyes.png'); }
.vera-container.v2-mode.takeover .vera-v2-mouth { background-image: url('assets/vera/v2/vera_takeover/vera_takeover_mouth.png'); }
.vera-container.v2-mode.takeover .vera-v2-hair { background-image: url('assets/vera/v2/vera_takeover/vera_takeover_hair.png'); }
.vera-container.v2-mode.takeover .vera-v2-wing-left { background-image: url('assets/vera/v2/vera_takeover/vera_takeover_wing_left.png'); }
.vera-container.v2-mode.takeover .vera-v2-wing-right { background-image: url('assets/vera/v2/vera_takeover/vera_takeover_wing_right.png'); }
.vera-container.v2-mode.takeover .vera-v2-tail { background-image: url('assets/vera/v2/vera_takeover/vera_takeover_tail.png'); }

/* ===== V2 MONSTER ASSETS ===== */
.vera-container.v2-mode.monster .vera-v2-body { background-image: url('assets/vera/v2/vera_monster/vera_monster_body.png'); }
.vera-container.v2-mode.monster .vera-v2-head { background-image: url('assets/vera/v2/vera_monster/vera_monster_head.png'); }
.vera-container.v2-mode.monster .vera-v2-eyes { background-image: url('assets/vera/v2/vera_monster/vera_monster_eyes.png'); }
.vera-container.v2-mode.monster .vera-v2-mouth { background-image: url('assets/vera/v2/vera_monster/vera_monster_mouth.png'); }
.vera-container.v2-mode.monster .vera-v2-hair { background-image: url('assets/vera/v2/vera_monster/vera_monster_hair.png'); }
.vera-container.v2-mode.monster .vera-v2-wing-left { background-image: url('assets/vera/v2/vera_monster/vera_monster_wing_left.png'); }
.vera-container.v2-mode.monster .vera-v2-wing-right { background-image: url('assets/vera/v2/vera_monster/vera_monster_wing_right.png'); }
.vera-container.v2-mode.monster .vera-v2-tail { background-image: url('assets/vera/v2/vera_monster/vera_monster_tail.png'); }

/* ==========================================================================
   PERFECT ANIMATIONS - SMOOTH AND PROFESSIONAL
   ========================================================================== */

/* ===== BLINKING ANIMATION (Eyes) ===== */
/* Moved to bottom of file - see v2BlinkNatural */

/* ===== WING FLAPPING - LEFT WING ===== */
/* NATURAL WING FLAP - 3D perspective with realistic motion */
@keyframes v2WingFlapLeft {
    0% {
        transform: rotateY(0deg) rotateZ(0deg) translateY(0) translateX(0);
    }
    10% {
        transform: rotateY(-8deg) rotateZ(-5deg) translateY(-2px) translateX(-1px);
    }
    25% {
        transform: rotateY(-15deg) rotateZ(-12deg) translateY(-5px) translateX(-3px);
    }
    40% {
        transform: rotateY(-20deg) rotateZ(-18deg) translateY(-8px) translateX(-4px);
    }
    50% {
        transform: rotateY(-22deg) rotateZ(-20deg) translateY(-10px) translateX(-5px);
    }
    60% {
        transform: rotateY(-18deg) rotateZ(-15deg) translateY(-7px) translateX(-3px);
    }
    75% {
        transform: rotateY(-10deg) rotateZ(-8deg) translateY(-4px) translateX(-2px);
    }
    90% {
        transform: rotateY(-3deg) rotateZ(-2deg) translateY(-1px) translateX(0);
    }
    100% {
        transform: rotateY(0deg) rotateZ(0deg) translateY(0) translateX(0);
    }
}

/* FAIRY - Fast, energetic flapping */
.vera-container.v2-mode.fairy .vera-v2-wing-left {
    animation: v2WingFlapLeft 0.8s cubic-bezier(0.42, 0, 0.58, 1) infinite;
}

/* PARTIAL - Medium speed, nervous energy */
.vera-container.v2-mode.partial .vera-v2-wing-left {
    animation: v2WingFlapLeft 1.0s cubic-bezier(0.45, 0.05, 0.55, 0.95) infinite;
}

/* TAKEOVER - Very fast, aggressive */
.vera-container.v2-mode.takeover .vera-v2-wing-left {
    animation: v2WingFlapLeft 0.5s cubic-bezier(0.5, 0, 0.5, 1) infinite;
}

/* MONSTER - Slow, powerful, menacing */
.vera-container.v2-mode.monster .vera-v2-wing-left {
    animation: v2WingFlapLeft 2.0s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* ===== WING FLAPPING - RIGHT WING (mirrored) ===== */
/* NATURAL WING FLAP - 3D perspective with realistic motion (opposite direction) */
@keyframes v2WingFlapRight {
    0% {
        transform: rotateY(0deg) rotateZ(0deg) translateY(0) translateX(0);
    }
    10% {
        transform: rotateY(8deg) rotateZ(5deg) translateY(-2px) translateX(1px);
    }
    25% {
        transform: rotateY(15deg) rotateZ(12deg) translateY(-5px) translateX(3px);
    }
    40% {
        transform: rotateY(20deg) rotateZ(18deg) translateY(-8px) translateX(4px);
    }
    50% {
        transform: rotateY(22deg) rotateZ(20deg) translateY(-10px) translateX(5px);
    }
    60% {
        transform: rotateY(18deg) rotateZ(15deg) translateY(-7px) translateX(3px);
    }
    75% {
        transform: rotateY(10deg) rotateZ(8deg) translateY(-4px) translateX(2px);
    }
    90% {
        transform: rotateY(3deg) rotateZ(2deg) translateY(-1px) translateX(0);
    }
    100% {
        transform: rotateY(0deg) rotateZ(0deg) translateY(0) translateX(0);
    }
}

/* FAIRY - Fast, energetic flapping (synchronized with left) */
.vera-container.v2-mode.fairy .vera-v2-wing-right {
    animation: v2WingFlapRight 0.8s cubic-bezier(0.42, 0, 0.58, 1) infinite;
}

/* PARTIAL - Medium speed, nervous energy */
.vera-container.v2-mode.partial .vera-v2-wing-right {
    animation: v2WingFlapRight 1.0s cubic-bezier(0.45, 0.05, 0.55, 0.95) infinite;
}

/* TAKEOVER - Very fast, aggressive */
.vera-container.v2-mode.takeover .vera-v2-wing-right {
    animation: v2WingFlapRight 0.5s cubic-bezier(0.5, 0, 0.5, 1) infinite;
}

/* MONSTER - Slow, powerful, menacing */
.vera-container.v2-mode.monster .vera-v2-wing-right {
    animation: v2WingFlapRight 2.0s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* ===== TAIL WHIPPING ANIMATION ===== */
/* ALIVE TAIL - Whips and coils with follow-through physics */
@keyframes v2TailWhipPartial {
    0% {
        transform: rotate(0deg) translateX(0) translateY(0);
    }
    15% {
        transform: rotate(8deg) translateX(3px) translateY(-1px);
    }
    35% {
        transform: rotate(18deg) translateX(7px) translateY(-2px);
    }
    50% {
        transform: rotate(12deg) translateX(5px) translateY(-1px);
    }
    65% {
        transform: rotate(-8deg) translateX(-3px) translateY(1px);
    }
    85% {
        transform: rotate(-15deg) translateX(-5px) translateY(2px);
    }
    100% {
        transform: rotate(0deg) translateX(0) translateY(0);
    }
}

@keyframes v2TailWhipAggressive {
    0% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleY(1);
    }
    10% {
        transform: rotate(15deg) translateX(5px) translateY(-2px) scaleY(1.05);
    }
    25% {
        transform: rotate(30deg) translateX(10px) translateY(-4px) scaleY(1.1);
    }
    40% {
        transform: rotate(20deg) translateX(7px) translateY(-2px) scaleY(1.03);
    }
    50% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleY(1);
    }
    60% {
        transform: rotate(-15deg) translateX(-5px) translateY(2px) scaleY(1.05);
    }
    75% {
        transform: rotate(-28deg) translateX(-9px) translateY(4px) scaleY(1.08);
    }
    90% {
        transform: rotate(-12deg) translateX(-4px) translateY(1px) scaleY(1.02);
    }
    100% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleY(1);
    }
}

@keyframes v2TailWhipMonster {
    0% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleY(1);
    }
    12% {
        transform: rotate(20deg) translateX(8px) translateY(-3px) scaleY(1.08);
    }
    28% {
        transform: rotate(38deg) translateX(14px) translateY(-6px) scaleY(1.15);
    }
    42% {
        transform: rotate(25deg) translateX(10px) translateY(-3px) scaleY(1.06);
    }
    50% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleY(1);
    }
    62% {
        transform: rotate(-20deg) translateX(-8px) translateY(3px) scaleY(1.08);
    }
    78% {
        transform: rotate(-35deg) translateX(-13px) translateY(6px) scaleY(1.12);
    }
    92% {
        transform: rotate(-15deg) translateX(-6px) translateY(2px) scaleY(1.04);
    }
    100% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleY(1);
    }
}

.vera-container.v2-mode.partial .vera-v2-tail {
    animation: v2TailWhipPartial 2.2s cubic-bezier(0.45, 0.05, 0.55, 0.95) infinite;
}

.vera-container.v2-mode.takeover .vera-v2-tail {
    animation: v2TailWhipAggressive 1.5s cubic-bezier(0.5, 0, 0.5, 1) infinite;
}

.vera-container.v2-mode.monster .vera-v2-tail {
    animation: v2TailWhipMonster 2.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* ===== HAIR SWAYING ANIMATION ===== */
/* FLOWING HAIR - Natural wind movement with follow-through delay */
@keyframes v2HairSwayFairy {
    0% {
        transform: rotate(0deg) translateX(0) translateY(0);
    }
    15% {
        transform: rotate(-2deg) translateX(-2px) translateY(1px);
    }
    30% {
        transform: rotate(-3deg) translateX(-3px) translateY(2px);
    }
    45% {
        transform: rotate(-1deg) translateX(-1px) translateY(1px);
    }
    50% {
        transform: rotate(0deg) translateX(0) translateY(0);
    }
    65% {
        transform: rotate(2deg) translateX(2px) translateY(-1px);
    }
    80% {
        transform: rotate(3deg) translateX(3px) translateY(-2px);
    }
    95% {
        transform: rotate(1deg) translateX(1px) translateY(-1px);
    }
    100% {
        transform: rotate(0deg) translateX(0) translateY(0);
    }
}

@keyframes v2HairSwayDramatic {
    0% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleX(1);
    }
    12% {
        transform: rotate(-5deg) translateX(-4px) translateY(2px) scaleX(1.02);
    }
    28% {
        transform: rotate(-8deg) translateX(-7px) translateY(4px) scaleX(1.05);
    }
    42% {
        transform: rotate(-4deg) translateX(-3px) translateY(2px) scaleX(1.01);
    }
    50% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleX(1);
    }
    62% {
        transform: rotate(5deg) translateX(4px) translateY(-2px) scaleX(1.02);
    }
    78% {
        transform: rotate(7deg) translateX(6px) translateY(-3px) scaleX(1.04);
    }
    92% {
        transform: rotate(3deg) translateX(2px) translateY(-1px) scaleX(1.01);
    }
    100% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleX(1);
    }
}

@keyframes v2HairSwayMonster {
    0% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleX(1) scaleY(1);
    }
    10% {
        transform: rotate(-8deg) translateX(-6px) translateY(3px) scaleX(1.05) scaleY(1.02);
    }
    25% {
        transform: rotate(-15deg) translateX(-12px) translateY(6px) scaleX(1.1) scaleY(1.05);
    }
    40% {
        transform: rotate(-10deg) translateX(-8px) translateY(4px) scaleX(1.06) scaleY(1.03);
    }
    50% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleX(1) scaleY(1);
    }
    60% {
        transform: rotate(8deg) translateX(6px) translateY(-3px) scaleX(1.05) scaleY(1.02);
    }
    75% {
        transform: rotate(14deg) translateX(11px) translateY(-5px) scaleX(1.08) scaleY(1.04);
    }
    90% {
        transform: rotate(6deg) translateX(5px) translateY(-2px) scaleX(1.03) scaleY(1.01);
    }
    100% {
        transform: rotate(0deg) translateX(0) translateY(0) scaleX(1) scaleY(1);
    }
}

/* FAIRY - Gentle flowing hair */
.vera-container.v2-mode.fairy .vera-v2-hair {
    animation: v2HairSwayFairy 4.5s cubic-bezier(0.42, 0, 0.58, 1) infinite;
}

/* PARTIAL - Medium dramatic sway */
.vera-container.v2-mode.partial .vera-v2-hair {
    animation: v2HairSwayDramatic 3.2s cubic-bezier(0.45, 0.05, 0.55, 0.95) infinite;
}

/* TAKEOVER - More dramatic, wild hair */
.vera-container.v2-mode.takeover .vera-v2-hair {
    animation: v2HairSwayDramatic 2.5s cubic-bezier(0.5, 0, 0.5, 1) infinite;
}

/* MONSTER - Wild, chaotic hair movement */
.vera-container.v2-mode.monster .vera-v2-hair {
    animation: v2HairSwayMonster 3.8s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* ===== MOUTH TALKING ANIMATION (when speaking) ===== */
/* REALISTIC TALKING - Multiple mouth positions for natural speech */
@keyframes v2MouthTalk {
    0% {
        opacity: 1;
        transform: translateY(0) scaleY(1);
    }
    15% {
        opacity: 0.75;
        transform: translateY(0.5px) scaleY(0.95);
    }
    30% {
        opacity: 1;
        transform: translateY(1px) scaleY(1.05);
    }
    45% {
        opacity: 0.8;
        transform: translateY(0.5px) scaleY(0.98);
    }
    60% {
        opacity: 1;
        transform: translateY(0) scaleY(1);
    }
    75% {
        opacity: 0.85;
        transform: translateY(0.5px) scaleY(1.02);
    }
    90% {
        opacity: 0.9;
        transform: translateY(0.3px) scaleY(0.97);
    }
    100% {
        opacity: 1;
        transform: translateY(0) scaleY(1);
    }
}

.vera-container.v2-mode.talking .vera-v2-mouth {
    animation: v2MouthTalk 0.25s ease-in-out infinite;
}

/* ===== FLOATING/BREATHING ANIMATION (Applied to entire V2 layers) ===== */
/* SMOOTH FLOATING - Gentle bob with subtle rotation for liveliness */
@keyframes v2FloatFairy {
    0% {
        transform: translateY(0) rotate(0deg);
    }
    25% {
        transform: translateY(-6px) rotate(0.8deg);
    }
    50% {
        transform: translateY(-10px) rotate(0deg);
    }
    75% {
        transform: translateY(-6px) rotate(-0.8deg);
    }
    100% {
        transform: translateY(0) rotate(0deg);
    }
}

@keyframes v2FloatUneasy {
    0% {
        transform: translateY(0) rotate(0deg);
    }
    20% {
        transform: translateY(-5px) rotate(1.2deg);
    }
    40% {
        transform: translateY(-8px) rotate(-0.5deg);
    }
    60% {
        transform: translateY(-10px) rotate(1.5deg);
    }
    80% {
        transform: translateY(-6px) rotate(-1deg);
    }
    100% {
        transform: translateY(0) rotate(0deg);
    }
}

@keyframes v2FloatMonster {
    0% {
        transform: translateY(0) rotate(0deg) scale(1);
    }
    30% {
        transform: translateY(-12px) rotate(1deg) scale(1.02);
    }
    60% {
        transform: translateY(-15px) rotate(-1deg) scale(1.01);
    }
    100% {
        transform: translateY(0) rotate(0deg) scale(1);
    }
}

/* FAIRY - Gentle, peaceful float */
.vera-container.v2-mode.fairy .vera-v2-layers {
    animation: v2FloatFairy 4.5s cubic-bezier(0.42, 0, 0.58, 1) infinite;
}

/* PARTIAL - Uneasy, jittery float */
.vera-container.v2-mode.partial .vera-v2-layers {
    animation: v2FloatUneasy 3.5s cubic-bezier(0.45, 0.05, 0.55, 0.95) infinite;
}

/* TAKEOVER - Aggressive float */
.vera-container.v2-mode.takeover .vera-v2-layers {
    animation: v2FloatUneasy 2.8s cubic-bezier(0.5, 0, 0.5, 1) infinite;
}

/* MONSTER - Heavy, powerful float */
.vera-container.v2-mode.monster .vera-v2-layers {
    animation: v2FloatMonster 5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* ==========================================================================
   TRANSFORMATION ANIMATION - SMOOTH STATE TRANSITIONS
   DRAMATIC FLASH + PULSE FOR STATE CHANGES
   ========================================================================== */
.vera-container.transforming .vera-v2-layers {
    animation: transformExplosion 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes transformExplosion {
    0% {
        transform: translateY(0) rotate(0deg) scale(1);
        filter: brightness(1) saturate(1) blur(0);
    }
    10% {
        transform: translateY(-3px) rotate(2deg) scale(1.08);
        filter: brightness(1.8) saturate(1.5) blur(1px);
    }
    20% {
        transform: translateY(-8px) rotate(-3deg) scale(1.15);
        filter: brightness(2.5) saturate(1.8) blur(2px);
    }
    35% {
        transform: translateY(-12px) rotate(4deg) scale(0.92);
        filter: brightness(2.2) saturate(0.6) blur(1px);
    }
    50% {
        transform: translateY(-10px) rotate(-2deg) scale(1.05);
        filter: brightness(1.5) saturate(1.3) blur(0.5px);
    }
    65% {
        transform: translateY(-5px) rotate(1deg) scale(0.98);
        filter: brightness(1.2) saturate(1.1) blur(0);
    }
    80% {
        transform: translateY(-2px) rotate(-1deg) scale(1.02);
        filter: brightness(1.1) saturate(1.05) blur(0);
    }
    100% {
        transform: translateY(0) rotate(0deg) scale(1);
        filter: brightness(1) saturate(1) blur(0);
    }
}

/* ENHANCED BLINKING - More natural and expressive */
@keyframes v2BlinkNatural {
    0%, 90% {
        opacity: 1;
        transform: scaleY(1);
    }
    92% {
        opacity: 0.8;
        transform: scaleY(0.6);
    }
    94% {
        opacity: 0.3;
        transform: scaleY(0.2);
    }
    95% {
        opacity: 0;
        transform: scaleY(0.05);
    }
    96% {
        opacity: 0.3;
        transform: scaleY(0.2);
    }
    98% {
        opacity: 0.8;
        transform: scaleY(0.6);
    }
    100% {
        opacity: 1;
        transform: scaleY(1);
    }
}

.vera-container.v2-mode .vera-v2-eyes {
    animation: v2BlinkNatural 6s ease-in-out infinite;
    transform-origin: 50% 50%;
}
